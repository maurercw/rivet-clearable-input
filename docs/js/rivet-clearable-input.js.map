{"version":3,"file":"rivet-clearable-input.js","sources":["../../src/js/rivet-clearable-input.js"],"sourcesContent":["/**\n * Copyright (C) 2019 The Trustees of Indiana University\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nvar CLEARABLE_ATTR = 'data-clearable';\n\nvar CLOSE_ICON = '<span class=\"rvt-sr-only\">Clear input</span>' +\n  '<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">' +\n  '<g fill=\"currentColor\">' +\n  '<path d=\"M8,0a8,8,0,1,0,8,8A8,8,0,0,0,8,0ZM8,14a6,6,0,1,1,6-6A6,6,0,0,1,8,14Z\"/>' +\n  '<path d=\"M10.83,5.17a1,1,0,0,0-1.41,0L8,6.59,6.59,5.17A1,1,0,0,0,5.17,6.59L6.59,8,5.17,9.41a1,1,0,1,0,1.41,1.41L8,9.41l1.41,1.41a1,1,0,0,0,1.41-1.41L9.41,8l1.41-1.41A1,1,0,0,0,10.83,5.17Z\"/>' +\n  '</g>' +\n  '</svg>';\n\n/**\n * Creates a new custom event and stores a reference\n * to the element's ID in the custom\n * event's options \"detail\" property.\n *\n * More here:\n * https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Adding_custom_data_%E2%80%93_CustomEvent()\n *\n */\nvar _fireCustomEvent = function (element, eventName) {\n  var event = new CustomEvent(eventName, {\n    bubbles: true,\n    detail: {\n      name: function () {\n        return element.id;\n      }\n    }\n  });\n\n  // Dispatch the event\n  element.dispatchEvent(event);\n}\n\n/**\n * Remove css classes from the element, clear the text, hide the button, fire the event\n */\nvar clearInput = function (element) {\n  element.classList.remove(\"hasData\");\n  element.value = '';\n  element.focus();\n\n  //Hide the button\n  var clearButton = createOrFindButton(element);\n  clearButton.setAttribute('hidden', '');\n\n  _fireCustomEvent(element, 'inputCleared');\n}\n\n/**\n * Event handler for the \"close\" button\n */\nvar _handleClick = function (event) {\n  var clearButton = event.target;\n\n  if (clearButton.classList.contains(\"buttonX\")) {\n    var inputId = clearButton.getAttribute(CLEARABLE_ATTR);\n    clearInput(document.getElementById(inputId));\n  }\n}\n\n/**\n * Event handler for input being entered into the text box\n */\nvar _handleInput = function (event) {\n  var clearableInput = event.target;\n  if (clearableInput.classList.contains(\"rvt-clearable-input\")) {\n    var clearButton = createOrFindButton(clearableInput);\n    //If we have content, show the button, otherwise, hide it\n    if (clearableInput.value.length > 0) {\n      clearableInput.classList.add(\"hasData\");\n      clearButton.removeAttribute('hidden');\n    } else {\n      clearableInput.classList.remove(\"hasData\");\n      clearButton.setAttribute('hidden', '');\n    }\n  }\n}\n\n/**\n * Create a new button, or return the element if it already exists\n */\nvar createOrFindButton = function (inputElement) {\n  var newButtonId = \"button_\" + inputElement.id;\n\n  //Make sure it doesn't exist already\n  var button = document.getElementById(newButtonId);\n\n  if (!button) {\n    button = document.createElement(\"button\");\n    button.type = \"button\";\n    button.setAttribute(CLEARABLE_ATTR, inputElement.id);\n    button.classList.add(\"buttonX\");\n    button.innerHTML = CLOSE_ICON;\n    button.id = newButtonId;\n    inputElement.parentNode.insertBefore(button, inputElement.nextSibling);\n  }\n\n  return button;\n}\n\nvar destroy = function (context) {\n  if (context === undefined) {\n    context = document;\n  }\n\n  context.removeEventListener('click', _handleClick, false);\n  context.removeEventListener('input', _handleInput, false);\n}\n\n/**\n * Adds all the event listeners to the input element(s)\n */\nvar init = function (context) {\n  // Optional element to bind the event listeners to\n  if (context === undefined) {\n    context = document;\n  }\n\n  context.addEventListener('click', _handleClick, false);\n  context.addEventListener('input', _handleInput, false);\n}\n\n/**\n * Export public APIs\n */\n\nexport { init, destroy, clearInput };"],"names":["CLEARABLE_ATTR","CLOSE_ICON","_fireCustomEvent","element","eventName","event","CustomEvent","bubbles","detail","name","id","dispatchEvent","clearInput","classList","remove","value","focus","clearButton","createOrFindButton","setAttribute","_handleClick","target","contains","inputId","getAttribute","document","getElementById","_handleInput","clearableInput","length","add","removeAttribute","inputElement","newButtonId","button","createElement","type","innerHTML","parentNode","insertBefore","nextSibling","destroy","context","undefined","removeEventListener","init","addEventListener"],"mappings":"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"}