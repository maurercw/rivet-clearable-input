{"version":3,"file":"rivet-clearable-input.js","sources":["../../src/js/rivet-clearable-input.js"],"sourcesContent":["var CLEARABLE_ATTR = 'data-clearable';\n\nvar CLOSE_ICON = '<span class=\"rvt-sr-only\">Clear input</span>' +\n    '<svg aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">' +\n    '<g fill=\"currentColor\">' +\n    '<path d=\"M8,0a8,8,0,1,0,8,8A8,8,0,0,0,8,0ZM8,14a6,6,0,1,1,6-6A6,6,0,0,1,8,14Z\"/>' +\n    '<path d=\"M10.83,5.17a1,1,0,0,0-1.41,0L8,6.59,6.59,5.17A1,1,0,0,0,5.17,6.59L6.59,8,5.17,9.41a1,1,0,1,0,1.41,1.41L8,9.41l1.41,1.41a1,1,0,0,0,1.41-1.41L9.41,8l1.41-1.41A1,1,0,0,0,10.83,5.17Z\"/>' +\n    '</g>' +\n    '</svg>';\n\n/**\n * Creates a new custom event and stores a reference\n * to the element's ID in the custom\n * event's options \"detail\" property.\n *\n * More here:\n * https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Adding_custom_data_%E2%80%93_CustomEvent()\n *\n */\nvar _fireCustomEvent = function (element, eventName) {\n    var event = new CustomEvent(eventName, {\n        bubbles: true,\n        detail: {\n            name: function () {\n              return element.id;\n            }\n        }\n    });\n\n    // Dispatch the event\n    element.dispatchEvent(event);\n}\n\n/**\n * Remove css classes from the element, clear the text, hide the button, fire the event\n */\nvar clearInput = function (element) {\n    element.classList.remove(\"has-data\");\n    element.value = '';\n    element.focus();\n\n    //Hide the button\n    var clearButton = createOrFindButton(element);\n    clearButton.setAttribute('hidden', '');\n\n    // Even if we clear the SR text, VoiceOver will not read it again the next time input is cleared.\n    // As a workaround, we are alternating adding a period at the end of the text so it looks like new text.\n    var srText = createOrFindSRMsg(element);\n    var currText = srText.textContent;\n    const input1 = \"Input cleared\";\n    const input2 = \"Input cleared.\";\n\n    srText.textContent = currText == input1 ? input2 : input1;\n\n    _fireCustomEvent(element, 'inputCleared');\n}\n\n    /**\n     * Event handler for the \"close\" button\n     */\n    var _handleClick = function(event) {\n        var clearButton = event.target;\n        if (clearButton.classList.contains(\"buttonX\")) {\n            var inputId = clearButton.getAttribute(CLEARABLE_ATTR);\n            clearInput(document.getElementById(inputId));\n        }\n\n    }\n\n/**\n * Event handler for input being entered into the text box\n */\nvar _handleInput = function (event) {\n    var clearableInput = event.target;\n    if (clearableInput.classList.contains(\"rvt-clearable-input\")) {\n        var clearButton = createOrFindButton(clearableInput);\n        var srMsg = createOrFindSRMsg(clearableInput);\n\n        //If we have content, show the button, otherwise, hide it\n        if (clearableInput.value.length > 0) {\n            clearableInput.classList.add(\"has-data\");\n            clearButton.removeAttribute('hidden');\n        } else {\n            clearableInput.classList.remove(\"has-data\");\n            clearButton.setAttribute('hidden', '');\n        }\n    }\n}\n\n/**\n * Create a new button, or return the element if it already exists\n */\nvar createOrFindButton = function (inputElement) {\n    var newButtonId = \"button_\" + inputElement.id;\n\n    //Make sure it doesn't exist already\n    var button = document.getElementById(newButtonId);\n\n    if (!button) {\n        button = document.createElement(\"button\");\n        button.type = \"button\";\n        button.setAttribute(CLEARABLE_ATTR, inputElement.id);\n        button.classList.add(\"buttonX\");\n        button.innerHTML = CLOSE_ICON;\n        button.id = newButtonId;\n        inputElement.parentNode.insertBefore(button, inputElement.nextSibling);\n    }\n\n    return button;\n}\n\nvar createOrFindSRMsg = function (inputElement) {\n    var srOnlyMsgId = \"sr-alert-\" + inputElement.id;\n\n    //Make sure it doesn't exist already\n    var srOnlyMsg = document.getElementById(srOnlyMsgId);\n    if (!srOnlyMsg) {\n        srOnlyMsg = document.createElement(\"span\");\n        srOnlyMsg.id = srOnlyMsgId;\n        srOnlyMsg.classList.add(\"rvt-sr-only\");\n        srOnlyMsg.setAttribute(\"aria-live\", \"polite\");\n        inputElement.parentNode.insertBefore(srOnlyMsg, inputElement.nextSibling);\n    }\n\n    return srOnlyMsg;\n}\n\nvar destroy = function (context) {\n    if (context === undefined) {\n        context = document;\n    }\n\n    context.removeEventListener('click', _handleClick, false);\n    context.removeEventListener('input', _handleInput, false);\n}\n\n/**\n * Adds all the event listeners to the input element(s)\n */\nvar init = function (context) {\n    // Optional element to bind the event listeners to\n    if (context === undefined) {\n      context = document;\n    }\n\n    context.addEventListener('click', _handleClick, false);\n    context.addEventListener('input', _handleInput, false);\n}\n\n/**\n * Export public APIs\n */\n\nexport { init, destroy, clearInput };"],"names":["CLEARABLE_ATTR","CLOSE_ICON","_fireCustomEvent","element","eventName","event","CustomEvent","bubbles","detail","name","id","dispatchEvent","clearInput","classList","remove","value","focus","clearButton","createOrFindButton","setAttribute","srText","createOrFindSRMsg","currText","textContent","input1","input2","_handleClick","target","contains","inputId","getAttribute","document","getElementById","_handleInput","clearableInput","length","add","removeAttribute","inputElement","newButtonId","button","createElement","type","innerHTML","parentNode","insertBefore","nextSibling","srOnlyMsgId","srOnlyMsg","destroy","context","undefined","removeEventListener","init","addEventListener"],"mappings":"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"}